getgenv().settings = {
    autoattack = true,
    minWait = 0.000001,
    maxWait = 0.000005,
    precision = 0.000000001
}

-- الخدمات
local Players = game:GetService("Players")
local Workspace = game:GetService("Workspace")
local RunService = game:GetService("RunService")
local camera = Workspace.CurrentCamera
local localPlayer = Players.LocalPlayer

-- إعدادات
local aimbotEnabled = true
local predictionFactor = 0.1 -- ← التنبؤ القديم
local lockPartName = "Head"

-- العدو = بدون فريق أو فريق مختلف
local function isEnemy(player)
    if not player or not player:IsA("Player") or player == localPlayer then return false end
    return not player.Team or not localPlayer.Team or player.Team ~= localPlayer.Team
end

-- تحقق من الحياة
local function isAlive(player)
    return player.Character and player.Character:FindFirstChild("Humanoid") and player.Character.Humanoid.Health > 0
end

-- فحص جدران قوي جدًا
local function isVisible(part)
    if not part then return false end
    local origin = camera.CFrame.Position
    local direction = part.Position - origin
    local rayParams = RaycastParams.new()
    rayParams.FilterDescendantsInstances = {localPlayer.Character, part.Parent}
    rayParams.FilterType = Enum.RaycastFilterType.Blacklist
    rayParams.IgnoreWater = true
    rayParams.CollisionGroup = "Default"
    local ray = Workspace:Raycast(origin, direction, rayParams)
    return not ray or ray.Instance:IsDescendantOf(part.Parent)
end

-- تنبؤ قديم (كما طلبت)
local function predictMovement(part)
    if not part then return part.Position end
    local velocity = part.Velocity
    return part.Position + (velocity * predictionFactor)
end

-- أقرب هدف
local function getBestTarget()
    local closestPart, closestDistance = nil, math.huge
    for _, player in ipairs(Players:GetPlayers()) do
        if isEnemy(player) and isAlive(player) then
            local part = player.Character and player.Character:FindFirstChild(lockPartName)
            if part and isVisible(part) then
                local distance = (part.Position - localPlayer.Character.HumanoidRootPart.Position).Magnitude
                if distance < closestDistance then
                    closestDistance = distance
                    closestPart = part
                end
            end
        end
    end
    return closestPart
end

-- حلقة التصويب
RunService.RenderStepped:Connect(function()
    if not aimbotEnabled then return end
    local targetPart = getBestTarget()
    if targetPart then
        local targetPos = predictMovement(targetPart)
        local camPos = camera.CFrame.Position
        camera.CFrame = CFrame.new(camPos, targetPos)
    end
end)

-- إشعار
pcall(function()
    game.StarterGui:SetCore("SendNotification", {
        Title = "✅ Aimbot مفعل",
        Text = "تم تحميل السكربت بنجاح",
        Duration = 10
    })
end)
